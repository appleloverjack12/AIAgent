# Dependencies - already installed in image
node_modules
bun.lock
package-lock.json
yarn.lock
pnpm-lock.yaml

# Source maps - large and not needed in production
*.js.map
*.ts.map
*.tsbuildinfo

# Tests - not needed in production
__tests__
test
tests
*.test.ts
*.spec.ts
*.test.js
*.spec.js
coverage
.nyc_output
jest.config.js
vitest.config.js
cypress
cypress.config.ts

# Source files - we only need compiled JS
src/*.ts
src/**/*.ts
!src/*.js
!src/**/*.js

# Documentation
README.md
CLAUDE.md
CONTRIBUTING.md
LICENSE
docs
*.md
!README.md

# Git and version control
.git
.gitignore
.gitattributes
.github
.gitlab

# Environment - never include these
.env
.env.*
.env.local
.env.example

# Logs
logs
*.log
npm-debug.log*
bun-debug.log*

# IDE and OS files
.vscode
.idea
*.swp
*.swo
*~
.DS_Store
Thumbs.db
desktop.ini

# Cache and temp files
.cache
.temp
.tmp
.eslintcache
.stylelintcache
.parcel-cache

# Build scripts - not needed at runtime
scripts/
bin/
tools/
*.sh
*.bash
*.zsh
build.ts
build.js
build-simple.js

# Config files - not needed in production
tsconfig.json
tsconfig.build.json
tailwind.config.js
postcss.config.js
vite.config.ts
cypress.config.ts
bunfig.toml

# Docker files
Dockerfile
.dockerignore
docker-compose.yml
docker-compose.yaml

# ElizaOS specific
characters/
clients/
plugins/
*.log
*.pid

# Frontend assets (if not needed)
public/
static/
assets/
*.css
*.scss
*.sass

# Build stage
FROM node:23.3.0-slim AS builder

WORKDIR /app
COPY package*.json ./
RUN npm install
COPY . .
RUN npm run build

# Production stage
FROM node:23.3.0-slim

WORKDIR /app
COPY --from=builder /app/dist ./dist
COPY --from=builder /app/node_modules ./node_modules
COPY --from=builder /app/package.json ./

CMD ["node", "dist/index.js"]